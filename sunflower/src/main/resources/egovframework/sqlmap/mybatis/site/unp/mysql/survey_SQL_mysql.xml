<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="site.unp.dao.survey.survey">

	<!-- 설문지 목록 -->
	<select id="findAllSurvey" parameterType="zvl" resultType="zvl">
		<![CDATA[
			/* findAllSurvey */

			SELECT	SV_SEQ, SV_ITEM01, SV_ITEM02, SV_ITEM03, SV_ITEM04, SV_ITEM05
					, SV_ITEM06, SV_ITEM07, SV_ITEM08, SV_ITEM09, SV_ITEM10
					, FN_GET_CODE_NAME('CM05', CENTER_CODE) AS CENTER_CODE_NAME
					, SV_CDATE, SV_CUSER
			FROM	TA_SURVEY S
			 WHERE  1 = 1
		]]>
		<if test='isBranch == "true"'>
			<if test='centerCode != null and centerCode != ""'>
				<![CDATA[ AND CENTER_CODE = #{centerCode}]]>
			</if>
			<if test='svCuser != null and svCuser != ""'>
				<![CDATA[ AND SV_CUSER = #{svCuser}]]>
			</if>
		</if>
		<if test='srcCntrGbn != null and srcCntrGbn != ""'>
			<![CDATA[ AND SUBSTR(CENTER_CODE, 1, 1) = #{srcCntrGbn}]]>
		</if>
		<if test='srcCntrCod != null and srcCntrCod != ""'>
			<![CDATA[ AND CENTER_CODE = #{srcCntrCod}]]>
		</if>
		<if test='srcSvItem03 != null and srcSvItem03 != ""'>
			<![CDATA[ AND SV_ITEM03 = #{srcSvItem03}]]>
		</if>
		<![CDATA[
		    ORDER BY SV_CDATE DESC
			limit #{firstIndex}, #{recordCountPerPage}
		]]>
	</select>

	<!-- 설문지 전체count수 -->
	<select id="countSurvey" parameterType="zvl" resultType="Long">
		<![CDATA[
			/* countSurvey  */
			
			SELECT  COUNT(SV_SEQ) AS totCnt
			  FROM  TA_SURVEY
			 WHERE  1 = 1
		]]>
		<if test='isBranch == "true"'>
			<if test='centerCode != null and centerCode != ""'>
				<![CDATA[ AND CENTER_CODE = #{centerCode}]]>
			</if>
			<if test='svCuser != null and svCuser != ""'>
				<![CDATA[ AND SV_CUSER = #{svCuser}]]>
			</if>
		</if>
		<if test='srcCntrGbn != null and srcCntrGbn != ""'>
			<![CDATA[ AND SUBSTR(CENTER_CODE, 1, 1) = #{srcCntrGbn}]]>
		</if>
		<if test='srcCntrCod != null and srcCntrCod != ""'>
			<![CDATA[ AND CENTER_CODE = #{srcCntrCod}]]>
		</if>
		<if test='srcSvItem03 != null and srcSvItem03 != ""'>
			<![CDATA[ AND SV_ITEM03 = #{srcSvItem03}]]>
		</if>
	</select>

	<!-- 설문지 상세 -->
	<select id="findOneSurvey" parameterType="zvl" resultType="zvl">
		<![CDATA[
			/* findOneSurvey  */
			
            SELECT	 SV_SEQ,SV_ITEM01,SV_ITEM02,SV_ITEM03,SV_ITEM04,SV_ITEM05
					,SV_ITEM06,SV_ITEM07,SV_ITEM08,SV_ITEM09,SV_ITEM10
					,SV_ITEM11,SV_ITEM12,SV_ITEM13,SV_ITEM14,SV_ITEM15,SV_ITEM16,SV_ITEM17,SV_ITEM18,SV_ITEM19,SV_ITEM20
					,SV_ITEM21,SV_ITEM22,SV_ITEM23,SV_ITEM24,SV_ITEM25,SV_ITEM26,SV_ITEM27,SV_ITEM28,SV_ITEM29,SV_ITEM30
					,SV_TEXT01, SV_CUSER
			FROM	TA_SURVEY
			WHERE	SV_SEQ = #{svSeq}
		]]>
	</select>

	<!-- 설문지 등록 -->
	<insert id="saveSurvey" parameterType="zvl">
		<selectKey resultType="Integer" order="BEFORE" keyProperty="svSeq">
			SELECT IFNULL(MAX(SV_SEQ),0)+1 AS SV_SEQ  FROM TA_SURVEY
		</selectKey>
		<![CDATA[
			/* saveSurvey  */
			
			INSERT INTO TA_SURVEY (
				SV_SEQ,SV_ITEM01,SV_ITEM02,SV_ITEM03,SV_ITEM04,SV_ITEM05,SV_ITEM06,SV_ITEM07,
				SV_ITEM08,SV_ITEM09,SV_ITEM10,SV_ITEM11,SV_ITEM12,SV_ITEM13,SV_ITEM14,SV_ITEM15,
				SV_ITEM16,SV_ITEM17,SV_ITEM18,SV_ITEM19,SV_ITEM20,SV_ITEM21,SV_ITEM22,SV_ITEM23,
				SV_ITEM24,SV_ITEM25,SV_ITEM26,SV_ITEM27,SV_ITEM28,SV_ITEM29,SV_ITEM30,SV_TEXT01, 
				CENTER_CODE, SV_CUSER, SV_CDATE) VALUES (
		    	#{svSeq}, #{svItem01}, #{svItem02}, #{svItem03}, #{svItem04}, #{svItem05}, #{svItem06}, #{svItem07},
				#{svItem08}, #{svItem09}, #{svItem10}, #{svItem11}, #{svItem12}, #{svItem13}, #{svItem14}, #{svItem15},
				#{svItem16}, #{svItem17}, #{svItem18}, #{svItem19}, #{svItem20}, #{svItem21}, #{svItem22}, #{svItem23},
				#{svItem24}, #{svItem25}, #{svItem26}, #{svItem27}, #{svItem28}, #{svItem29}, #{svItem30}, #{svText01}, 
				#{centerCode}, #{svCuser}, NOW()
		    )
		]]>
	</insert>

	<!-- 설문지 수정-->
	<update id="updateSurvey" parameterType="zvl">
		<![CDATA[
		/* updateSurvey */
		
		UPDATE	TA_SURVEY SET
				SV_ITEM01 = #{svItem01},
				SV_ITEM02 = #{svItem02},
				SV_ITEM03 = #{svItem03},
				SV_ITEM04 = #{svItem04},
				SV_ITEM05 = #{svItem05},
				SV_ITEM06 = #{svItem06},
				SV_ITEM07 = #{svItem07},
				SV_ITEM08 = #{svItem08},
				SV_ITEM09 = #{svItem09},
				SV_ITEM10 = #{svItem10},
				SV_ITEM11 = #{svItem11},
				SV_ITEM12 = #{svItem12},
				SV_ITEM13 = #{svItem13},
				SV_ITEM14 = #{svItem14},
				SV_ITEM15 = #{svItem15},
				SV_ITEM16 = #{svItem16},
				SV_ITEM17 = #{svItem17},
				SV_ITEM18 = #{svItem18},
				SV_ITEM19 = #{svItem19},
				SV_ITEM20 = #{svItem20},
				SV_ITEM21 = #{svItem21},
				SV_ITEM22 = #{svItem22},
				SV_ITEM23 = #{svItem23},
				SV_ITEM24 = #{svItem24},
				SV_ITEM25 = #{svItem25},
				SV_ITEM26 = #{svItem26},
				SV_ITEM27 = #{svItem27},
				SV_ITEM28 = #{svItem28},
				SV_ITEM29 = #{svItem29},
				SV_ITEM30 = #{svItem30},
				SV_TEXT01 = #{svText01}
		WHERE	SV_SEQ = #{svSeq}
		]]>
	</update>

	<!-- 설문지 삭제(사용안함)-->
	<delete id="deleteSurvey" parameterType="zvl">
		<![CDATA[
		/* deleteSurvey */
		
            DELETE FROM TA_SURVEY
			WHERE SV_SEQ = #{svSeq}
		]]>
	</delete>
	
	<select id="findSurveyStats" parameterType="zvl" resultType="zvl">
		<![CDATA[
		SELECT	IFNULL(SUM(SV_ITEM011), 0) AS SV_ITEM011, IFNULL(SUM(SV_ITEM012), 0) AS SV_ITEM012
				, IFNULL(SUM(SV_ITEM021), 0) AS SV_ITEM021, IFNULL(SUM(SV_ITEM022), 0) AS SV_ITEM022, IFNULL(SUM(SV_ITEM023), 0) AS SV_ITEM023
				, IFNULL(SUM(SV_ITEM024), 0) AS SV_ITEM024, IFNULL(SUM(SV_ITEM025), 0) AS SV_ITEM025, IFNULL(SUM(SV_ITEM026), 0) AS SV_ITEM026
				, IFNULL(SUM(SV_ITEM06), 0) AS SV_ITEM06, IFNULL(SUM(SV_ITEM07), 0) AS SV_ITEM07, IFNULL(SUM(SV_ITEM08), 0) AS SV_ITEM08, IFNULL(SUM(SV_ITEM10), 0) AS SV_ITEM10
				, IFNULL(SUM(SV_ITEM110), 0) AS SV_ITEM110, IFNULL(SUM(SV_ITEM111), 0) AS SV_ITEM111, IFNULL(SUM(SV_ITEM112), 0) AS SV_ITEM112, IFNULL(SUM(SV_ITEM113), 0) AS SV_ITEM113
				, IFNULL(SUM(SV_ITEM114), 0) AS SV_ITEM114, IFNULL(SUM(SV_ITEM115), 0) AS SV_ITEM115, IFNULL(SUM(SV_ITEM116), 0) AS SV_ITEM116
				, IFNULL(SUM(SV_ITEM120), 0) AS SV_ITEM120, IFNULL(SUM(SV_ITEM121), 0) AS SV_ITEM121, IFNULL(SUM(SV_ITEM122), 0) AS SV_ITEM122, IFNULL(SUM(SV_ITEM123), 0) AS SV_ITEM123
				, IFNULL(SUM(SV_ITEM124), 0) AS SV_ITEM124, IFNULL(SUM(SV_ITEM125), 0) AS SV_ITEM125, IFNULL(SUM(SV_ITEM126), 0) AS SV_ITEM126
				, IFNULL(SUM(SV_ITEM130), 0) AS SV_ITEM130, IFNULL(SUM(SV_ITEM131), 0) AS SV_ITEM131, IFNULL(SUM(SV_ITEM132), 0) AS SV_ITEM132, IFNULL(SUM(SV_ITEM133), 0) AS SV_ITEM133
				, IFNULL(SUM(SV_ITEM134), 0) AS SV_ITEM134, IFNULL(SUM(SV_ITEM135), 0) AS SV_ITEM135, IFNULL(SUM(SV_ITEM136), 0) AS SV_ITEM136
				, IFNULL(SUM(SV_ITEM140), 0) AS SV_ITEM140, IFNULL(SUM(SV_ITEM141), 0) AS SV_ITEM141, IFNULL(SUM(SV_ITEM142), 0) AS SV_ITEM142, IFNULL(SUM(SV_ITEM143), 0) AS SV_ITEM143
				, IFNULL(SUM(SV_ITEM144), 0) AS SV_ITEM144, IFNULL(SUM(SV_ITEM145), 0) AS SV_ITEM145, IFNULL(SUM(SV_ITEM146), 0) AS SV_ITEM146
				, IFNULL(SUM(SV_ITEM150), 0) AS SV_ITEM150, IFNULL(SUM(SV_ITEM151), 0) AS SV_ITEM151, IFNULL(SUM(SV_ITEM152), 0) AS SV_ITEM152, IFNULL(SUM(SV_ITEM153), 0) AS SV_ITEM153
				, IFNULL(SUM(SV_ITEM154), 0) AS SV_ITEM154, IFNULL(SUM(SV_ITEM155), 0) AS SV_ITEM155, IFNULL(SUM(SV_ITEM156), 0) AS SV_ITEM156
				, IFNULL(SUM(SV_ITEM160), 0) AS SV_ITEM160, IFNULL(SUM(SV_ITEM161), 0) AS SV_ITEM161, IFNULL(SUM(SV_ITEM162), 0) AS SV_ITEM162, IFNULL(SUM(SV_ITEM163), 0) AS SV_ITEM163
				, IFNULL(SUM(SV_ITEM164), 0) AS SV_ITEM164, IFNULL(SUM(SV_ITEM165), 0) AS SV_ITEM165, IFNULL(SUM(SV_ITEM166), 0) AS SV_ITEM166
				, IFNULL(SUM(SV_ITEM170), 0) AS SV_ITEM170, IFNULL(SUM(SV_ITEM171), 0) AS SV_ITEM171, IFNULL(SUM(SV_ITEM172), 0) AS SV_ITEM172, IFNULL(SUM(SV_ITEM173), 0) AS SV_ITEM173
				, IFNULL(SUM(SV_ITEM174), 0) AS SV_ITEM174, IFNULL(SUM(SV_ITEM175), 0) AS SV_ITEM175, IFNULL(SUM(SV_ITEM176), 0) AS SV_ITEM176
				, IFNULL(SUM(SV_ITEM180), 0) AS SV_ITEM180, IFNULL(SUM(SV_ITEM181), 0) AS SV_ITEM181, IFNULL(SUM(SV_ITEM182), 0) AS SV_ITEM182, IFNULL(SUM(SV_ITEM183), 0) AS SV_ITEM183
				, IFNULL(SUM(SV_ITEM184), 0) AS SV_ITEM184, IFNULL(SUM(SV_ITEM185), 0) AS SV_ITEM185, IFNULL(SUM(SV_ITEM186), 0) AS SV_ITEM186
				, IFNULL(SUM(SV_ITEM190), 0) AS SV_ITEM190, IFNULL(SUM(SV_ITEM191), 0) AS SV_ITEM191, IFNULL(SUM(SV_ITEM192), 0) AS SV_ITEM192, IFNULL(SUM(SV_ITEM193), 0) AS SV_ITEM193
				, IFNULL(SUM(SV_ITEM194), 0) AS SV_ITEM194, IFNULL(SUM(SV_ITEM195), 0) AS SV_ITEM195, IFNULL(SUM(SV_ITEM196), 0) AS SV_ITEM196
				, IFNULL(SUM(SV_ITEM200), 0) AS SV_ITEM200, IFNULL(SUM(SV_ITEM201), 0) AS SV_ITEM201, IFNULL(SUM(SV_ITEM202), 0) AS SV_ITEM202, IFNULL(SUM(SV_ITEM203), 0) AS SV_ITEM203
				, IFNULL(SUM(SV_ITEM204), 0) AS SV_ITEM204, IFNULL(SUM(SV_ITEM205), 0) AS SV_ITEM205, IFNULL(SUM(SV_ITEM206), 0) AS SV_ITEM206
				, IFNULL(SUM(SV_ITEM210), 0) AS SV_ITEM210, IFNULL(SUM(SV_ITEM211), 0) AS SV_ITEM211, IFNULL(SUM(SV_ITEM212), 0) AS SV_ITEM212, IFNULL(SUM(SV_ITEM213), 0) AS SV_ITEM213
				, IFNULL(SUM(SV_ITEM214), 0) AS SV_ITEM214, IFNULL(SUM(SV_ITEM215), 0) AS SV_ITEM215, IFNULL(SUM(SV_ITEM216), 0) AS SV_ITEM216
				, IFNULL(SUM(SV_ITEM220), 0) AS SV_ITEM220, IFNULL(SUM(SV_ITEM221), 0) AS SV_ITEM221, IFNULL(SUM(SV_ITEM222), 0) AS SV_ITEM222, IFNULL(SUM(SV_ITEM223), 0) AS SV_ITEM223
				, IFNULL(SUM(SV_ITEM224), 0) AS SV_ITEM224, IFNULL(SUM(SV_ITEM225), 0) AS SV_ITEM225, IFNULL(SUM(SV_ITEM226), 0) AS SV_ITEM226
				, IFNULL(SUM(SV_ITEM230), 0) AS SV_ITEM230, IFNULL(SUM(SV_ITEM231), 0) AS SV_ITEM231, IFNULL(SUM(SV_ITEM232), 0) AS SV_ITEM232, IFNULL(SUM(SV_ITEM233), 0) AS SV_ITEM233
				, IFNULL(SUM(SV_ITEM234), 0) AS SV_ITEM234, IFNULL(SUM(SV_ITEM235), 0) AS SV_ITEM235, IFNULL(SUM(SV_ITEM236), 0) AS SV_ITEM236
				, IFNULL(SUM(SV_ITEM240), 0) AS SV_ITEM240, IFNULL(SUM(SV_ITEM241), 0) AS SV_ITEM241, IFNULL(SUM(SV_ITEM242), 0) AS SV_ITEM242, IFNULL(SUM(SV_ITEM243), 0) AS SV_ITEM243
				, IFNULL(SUM(SV_ITEM244), 0) AS SV_ITEM244, IFNULL(SUM(SV_ITEM245), 0) AS SV_ITEM245, IFNULL(SUM(SV_ITEM246), 0) AS SV_ITEM246
			FROM (
				SELECT	CASE SV_ITEM01 WHEN '1' THEN 1 ELSE 0 END AS SV_ITEM011
					, CASE SV_ITEM01 WHEN '2' THEN 1 ELSE 0 END AS SV_ITEM012
					, CASE WHEN SV_ITEM02<=10 THEN 1 ELSE 0 END AS SV_ITEM021
					, CASE WHEN SV_ITEM02<=20 AND SV_ITEM02>10 THEN 1 ELSE 0 END AS SV_ITEM022
					, CASE WHEN SV_ITEM02<=30 AND SV_ITEM02>20 THEN 1 ELSE 0 END AS SV_ITEM023
					, CASE WHEN SV_ITEM02<=40 AND SV_ITEM02>30 THEN 1 ELSE 0 END AS SV_ITEM024
					, CASE WHEN SV_ITEM02<=50 AND SV_ITEM02>40 THEN 1 ELSE 0 END AS SV_ITEM025
					, CASE WHEN SV_ITEM02>50 THEN 1 ELSE 0 END AS SV_ITEM026
					, CASE SV_ITEM06 WHEN 'Y' THEN 1 ELSE 0 END AS SV_ITEM06
					, CASE SV_ITEM07 WHEN 'Y' THEN 1 ELSE 0 END AS SV_ITEM07
					, CASE SV_ITEM08 WHEN 'Y' THEN 1 ELSE 0 END AS SV_ITEM08
					, CASE SV_ITEM10 WHEN 'Y' THEN 1 ELSE 0 END AS SV_ITEM10
					, CASE SV_ITEM11 WHEN '0' THEN 1 ELSE 0 END AS SV_ITEM110
					, CASE SV_ITEM11 WHEN '1' THEN 1 ELSE 0 END AS SV_ITEM111
					, CASE SV_ITEM11 WHEN '2' THEN 1 ELSE 0 END AS SV_ITEM112
					, CASE SV_ITEM11 WHEN '3' THEN 1 ELSE 0 END AS SV_ITEM113
					, CASE SV_ITEM11 WHEN '4' THEN 1 ELSE 0 END AS SV_ITEM114
					, CASE SV_ITEM11 WHEN '5' THEN 1 ELSE 0 END AS SV_ITEM115
					, CASE SV_ITEM11 WHEN '6' THEN 1 ELSE 0 END AS SV_ITEM116
					, CASE SV_ITEM12 WHEN '0' THEN 1 ELSE 0 END AS SV_ITEM120
					, CASE SV_ITEM12 WHEN '1' THEN 1 ELSE 0 END AS SV_ITEM121
					, CASE SV_ITEM12 WHEN '2' THEN 1 ELSE 0 END AS SV_ITEM122
					, CASE SV_ITEM12 WHEN '3' THEN 1 ELSE 0 END AS SV_ITEM123
					, CASE SV_ITEM12 WHEN '4' THEN 1 ELSE 0 END AS SV_ITEM124
					, CASE SV_ITEM12 WHEN '5' THEN 1 ELSE 0 END AS SV_ITEM125
					, CASE SV_ITEM12 WHEN '6' THEN 1 ELSE 0 END AS SV_ITEM126
					, CASE SV_ITEM13 WHEN '0' THEN 1 ELSE 0 END AS SV_ITEM130
					, CASE SV_ITEM13 WHEN '1' THEN 1 ELSE 0 END AS SV_ITEM131
					, CASE SV_ITEM13 WHEN '2' THEN 1 ELSE 0 END AS SV_ITEM132
					, CASE SV_ITEM13 WHEN '3' THEN 1 ELSE 0 END AS SV_ITEM133
					, CASE SV_ITEM13 WHEN '4' THEN 1 ELSE 0 END AS SV_ITEM134
					, CASE SV_ITEM13 WHEN '5' THEN 1 ELSE 0 END AS SV_ITEM135
					, CASE SV_ITEM13 WHEN '6' THEN 1 ELSE 0 END AS SV_ITEM136
					, CASE SV_ITEM14 WHEN '0' THEN 1 ELSE 0 END AS SV_ITEM140
					, CASE SV_ITEM14 WHEN '1' THEN 1 ELSE 0 END AS SV_ITEM141
					, CASE SV_ITEM14 WHEN '2' THEN 1 ELSE 0 END AS SV_ITEM142
					, CASE SV_ITEM14 WHEN '3' THEN 1 ELSE 0 END AS SV_ITEM143
					, CASE SV_ITEM14 WHEN '4' THEN 1 ELSE 0 END AS SV_ITEM144
					, CASE SV_ITEM14 WHEN '5' THEN 1 ELSE 0 END AS SV_ITEM145
					, CASE SV_ITEM14 WHEN '6' THEN 1 ELSE 0 END AS SV_ITEM146
					, CASE SV_ITEM15 WHEN '0' THEN 1 ELSE 0 END AS SV_ITEM150
					, CASE SV_ITEM15 WHEN '1' THEN 1 ELSE 0 END AS SV_ITEM151
					, CASE SV_ITEM15 WHEN '2' THEN 1 ELSE 0 END AS SV_ITEM152
					, CASE SV_ITEM15 WHEN '3' THEN 1 ELSE 0 END AS SV_ITEM153
					, CASE SV_ITEM15 WHEN '4' THEN 1 ELSE 0 END AS SV_ITEM154
					, CASE SV_ITEM15 WHEN '5' THEN 1 ELSE 0 END AS SV_ITEM155
					, CASE SV_ITEM15 WHEN '6' THEN 1 ELSE 0 END AS SV_ITEM156
					, CASE SV_ITEM16 WHEN '0' THEN 1 ELSE 0 END AS SV_ITEM160
					, CASE SV_ITEM16 WHEN '1' THEN 1 ELSE 0 END AS SV_ITEM161
					, CASE SV_ITEM16 WHEN '2' THEN 1 ELSE 0 END AS SV_ITEM162
					, CASE SV_ITEM16 WHEN '3' THEN 1 ELSE 0 END AS SV_ITEM163
					, CASE SV_ITEM16 WHEN '4' THEN 1 ELSE 0 END AS SV_ITEM164
					, CASE SV_ITEM16 WHEN '5' THEN 1 ELSE 0 END AS SV_ITEM165
					, CASE SV_ITEM16 WHEN '6' THEN 1 ELSE 0 END AS SV_ITEM166
					, CASE SV_ITEM17 WHEN '0' THEN 1 ELSE 0 END AS SV_ITEM170
					, CASE SV_ITEM17 WHEN '1' THEN 1 ELSE 0 END AS SV_ITEM171
					, CASE SV_ITEM17 WHEN '2' THEN 1 ELSE 0 END AS SV_ITEM172
					, CASE SV_ITEM17 WHEN '3' THEN 1 ELSE 0 END AS SV_ITEM173
					, CASE SV_ITEM17 WHEN '4' THEN 1 ELSE 0 END AS SV_ITEM174
					, CASE SV_ITEM17 WHEN '5' THEN 1 ELSE 0 END AS SV_ITEM175
					, CASE SV_ITEM17 WHEN '6' THEN 1 ELSE 0 END AS SV_ITEM176
					, CASE SV_ITEM18 WHEN '0' THEN 1 ELSE 0 END AS SV_ITEM180
					, CASE SV_ITEM18 WHEN '1' THEN 1 ELSE 0 END AS SV_ITEM181
					, CASE SV_ITEM18 WHEN '2' THEN 1 ELSE 0 END AS SV_ITEM182
					, CASE SV_ITEM18 WHEN '3' THEN 1 ELSE 0 END AS SV_ITEM183
					, CASE SV_ITEM18 WHEN '4' THEN 1 ELSE 0 END AS SV_ITEM184
					, CASE SV_ITEM18 WHEN '5' THEN 1 ELSE 0 END AS SV_ITEM185
					, CASE SV_ITEM18 WHEN '6' THEN 1 ELSE 0 END AS SV_ITEM186
					, CASE SV_ITEM19 WHEN '0' THEN 1 ELSE 0 END AS SV_ITEM190
					, CASE SV_ITEM19 WHEN '1' THEN 1 ELSE 0 END AS SV_ITEM191
					, CASE SV_ITEM19 WHEN '2' THEN 1 ELSE 0 END AS SV_ITEM192
					, CASE SV_ITEM19 WHEN '3' THEN 1 ELSE 0 END AS SV_ITEM193
					, CASE SV_ITEM19 WHEN '4' THEN 1 ELSE 0 END AS SV_ITEM194
					, CASE SV_ITEM19 WHEN '5' THEN 1 ELSE 0 END AS SV_ITEM195
					, CASE SV_ITEM19 WHEN '6' THEN 1 ELSE 0 END AS SV_ITEM196
					, CASE SV_ITEM20 WHEN '0' THEN 1 ELSE 0 END AS SV_ITEM200
					, CASE SV_ITEM20 WHEN '1' THEN 1 ELSE 0 END AS SV_ITEM201
					, CASE SV_ITEM20 WHEN '2' THEN 1 ELSE 0 END AS SV_ITEM202
					, CASE SV_ITEM20 WHEN '3' THEN 1 ELSE 0 END AS SV_ITEM203
					, CASE SV_ITEM20 WHEN '4' THEN 1 ELSE 0 END AS SV_ITEM204
					, CASE SV_ITEM20 WHEN '5' THEN 1 ELSE 0 END AS SV_ITEM205
					, CASE SV_ITEM20 WHEN '6' THEN 1 ELSE 0 END AS SV_ITEM206
					, CASE SV_ITEM21 WHEN '0' THEN 1 ELSE 0 END AS SV_ITEM210
					, CASE SV_ITEM21 WHEN '1' THEN 1 ELSE 0 END AS SV_ITEM211
					, CASE SV_ITEM21 WHEN '2' THEN 1 ELSE 0 END AS SV_ITEM212
					, CASE SV_ITEM21 WHEN '3' THEN 1 ELSE 0 END AS SV_ITEM213
					, CASE SV_ITEM21 WHEN '4' THEN 1 ELSE 0 END AS SV_ITEM214
					, CASE SV_ITEM21 WHEN '5' THEN 1 ELSE 0 END AS SV_ITEM215
					, CASE SV_ITEM21 WHEN '6' THEN 1 ELSE 0 END AS SV_ITEM216
					, CASE SV_ITEM22 WHEN '0' THEN 1 ELSE 0 END AS SV_ITEM220
					, CASE SV_ITEM22 WHEN '1' THEN 1 ELSE 0 END AS SV_ITEM221
					, CASE SV_ITEM22 WHEN '2' THEN 1 ELSE 0 END AS SV_ITEM222
					, CASE SV_ITEM22 WHEN '3' THEN 1 ELSE 0 END AS SV_ITEM223
					, CASE SV_ITEM22 WHEN '4' THEN 1 ELSE 0 END AS SV_ITEM224
					, CASE SV_ITEM22 WHEN '5' THEN 1 ELSE 0 END AS SV_ITEM225
					, CASE SV_ITEM22 WHEN '6' THEN 1 ELSE 0 END AS SV_ITEM226
					, CASE SV_ITEM23 WHEN '0' THEN 1 ELSE 0 END AS SV_ITEM230
					, CASE SV_ITEM23 WHEN '1' THEN 1 ELSE 0 END AS SV_ITEM231
					, CASE SV_ITEM23 WHEN '2' THEN 1 ELSE 0 END AS SV_ITEM232
					, CASE SV_ITEM23 WHEN '3' THEN 1 ELSE 0 END AS SV_ITEM233
					, CASE SV_ITEM23 WHEN '4' THEN 1 ELSE 0 END AS SV_ITEM234
					, CASE SV_ITEM23 WHEN '5' THEN 1 ELSE 0 END AS SV_ITEM235
					, CASE SV_ITEM23 WHEN '6' THEN 1 ELSE 0 END AS SV_ITEM236
					, CASE SV_ITEM24 WHEN '0' THEN 1 ELSE 0 END AS SV_ITEM240
					, CASE SV_ITEM24 WHEN '1' THEN 1 ELSE 0 END AS SV_ITEM241
					, CASE SV_ITEM24 WHEN '2' THEN 1 ELSE 0 END AS SV_ITEM242
					, CASE SV_ITEM24 WHEN '3' THEN 1 ELSE 0 END AS SV_ITEM243
					, CASE SV_ITEM24 WHEN '4' THEN 1 ELSE 0 END AS SV_ITEM244
					, CASE SV_ITEM24 WHEN '5' THEN 1 ELSE 0 END AS SV_ITEM245
					, CASE SV_ITEM24 WHEN '6' THEN 1 ELSE 0 END AS SV_ITEM246
				FROM	TA_SURVEY
				WHERE	CENTER_CODE NOT IN ('701')
			]]>
			<if test="srcSvItem03 != null and srcSvItem03 != ''">
				<![CDATA[	AND SV_ITEM03 = #{srcSvItem03}]]>
			</if>
			<choose>
				<when test='isBranch == "true"'>
					<if test='centerCode != null and centerCode != ""'>
						<![CDATA[ AND CENTER_CODE = #{centerCode}]]>
					</if>
				</when>
				<otherwise>
					<if test='srcCntrGbn != null and srcCntrGbn != ""'>
						<![CDATA[ AND CENTER_CODE IN (SELECT CODE_CODE FROM TB_CODE WHERE CODEG_CODE='CM05' AND CODE_GROUP=#{srcCntrGbn})]]>
					</if>
					<if test='srcCntrCod != null and srcCntrCod != ""'>
						<![CDATA[ AND CENTER_CODE = #{srcCntrCod}]]>
					</if>
				</otherwise>
			</choose>
			<![CDATA[
				) a
			]]>
	</select>
	
	<select id="findSurveyStatsText" parameterType="zvl" resultType="zvl">
		<![CDATA[
		SELECT	SV_TEXT01 
		FROM	TA_SURVEY
		WHERE	CENTER_CODE NOT IN ('701')
		]]>
		<if test="srcSvItem03 != null and srcSvItem03 != ''">
			<![CDATA[	AND SV_ITEM03 = #{srcSvItem03}]]>
		</if>
		<choose>
			<when test='isBranch == "true"'>
				<if test='centerCode != null and centerCode != ""'>
					<![CDATA[ AND CENTER_CODE = #{centerCode}]]>
				</if>
			</when>
			<otherwise>
				<if test='srcCntrGbn != null and srcCntrGbn != ""'>
					<![CDATA[ AND CENTER_CODE IN (SELECT CODE_CODE FROM TB_CODE WHERE CODEG_CODE='CM05' AND CODE_GROUP=#{srcCntrGbn})]]>
				</if>
				<if test='srcCntrCod != null and srcCntrCod != ""'>
					<![CDATA[ AND CENTER_CODE = #{srcCntrCod}]]>
				</if>
			</otherwise>
		</choose>
	</select>
	
	<select id="searchCodeSelect" parameterType="zvl" resultType="zvl">
		<![CDATA[
		/* searchCodeSelect */
		
		SELECT	CODE_CODE AS CD_NO, CODE_NAME AS CD_NM, CODE_SUBCODE AS CDSUB 
		FROM	TB_CODE
		WHERE	CODEG_CODE = #{sCode}
				AND	CODE_USE_YN = 'Y'
		]]>
		<if test="sCode	== 'CM04'">
			AND CODE_CODE IN ('1', '2', '3'
				<if test="menuNo == '100201' or menuNo == '100184' or menuNo == '100185' or menuNo == '100241' or codeAt = 'Y'">
				, '7'
				</if>
			)
		</if>
		<if test="gCode != null and gCode != ''">
			AND SUBSTR(CODE_CODE, 1, 1) = #{gCode}
		</if>
		<![CDATA[
		ORDER BY CODE_SORT
		]]>
	</select>
	
	<select id="surveyStatsCenterSum" parameterType="zvl" resultType="zvl">
		<![CDATA[
			/* findSurveyStatsCenterSum */
			
			SELECT	IFNULL(SUM( CASE SV_ITEM01 WHEN 1 THEN 1 ELSE 0 END), 0) AS SV_ITEM011
					, IFNULL(SUM( CASE SV_ITEM01 WHEN '2' THEN 1 ELSE 0 END), 0) AS SV_ITEM012
			FROM	TA_SURVEY 
			WHERE	CENTER_CODE NOT IN ('701') 
					AND SV_ITEM03 = #{srcSvItem03}
		]]>
	</select>
	
	<select id="surveyStatsCenter" parameterType="zvl" resultType="zvl">
		<![CDATA[
			/* findSurveyStatsCenter */
			
			SELECT	CENTER_CODE AS CENTER_ID
					, FN_GET_CODE_NAME('CM05', CENTER_CODE) AS CENTER_CODE
					, IFNULL(SUM( CASE SV_ITEM01 WHEN 1 THEN 1 ELSE 0 END), 0) AS SV_ITEM011
					, IFNULL(SUM( CASE SV_ITEM01 WHEN '2' THEN 1 ELSE 0 END), 0) AS SV_ITEM012
			FROM	TA_SURVEY WHERE CENTER_CODE NOT IN ('701') AND SV_ITEM03 = #{srcSvItem03}
			GROUP BY CENTER_CODE
			ORDER BY CENTER_ID
		]]>
	</select>
</mapper>